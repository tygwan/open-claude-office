{
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "Bash",
        "hooks": [{"type": "command", "command": ".claude/hooks/pre-tool-use-safety.sh Bash"}]
      },
      {
        "matcher": "Write",
        "hooks": [{"type": "command", "command": ".claude/hooks/pre-tool-use-safety.sh Write"}]
      },
      {
        "matcher": "Edit",
        "hooks": [{"type": "command", "command": ".claude/hooks/pre-tool-use-safety.sh Edit"}]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Bash",
        "hooks": [
          {"type": "command", "command": ".claude/hooks/auto-doc-sync.sh Bash"},
          {"type": "command", "command": ".claude/hooks/post-tool-use-tracker.sh Bash"},
          {"type": "command", "command": ".claude/hooks/notion-sync.sh Bash"}
        ]
      },
      {
        "matcher": "Write",
        "hooks": [
          {"type": "command", "command": ".claude/hooks/auto-doc-sync.sh Write"},
          {"type": "command", "command": ".claude/hooks/phase-progress.sh Write"},
          {"type": "command", "command": ".claude/hooks/post-tool-use-tracker.sh Write"},
          {"type": "command", "command": ".claude/hooks/state-transition.sh Write"},
          {"type": "command", "command": ".claude/hooks/craft-progress.sh Write"},
          {"type": "command", "command": ".claude/hooks/notion-sync.sh Write"}
        ]
      },
      {
        "matcher": "Edit",
        "hooks": [
          {"type": "command", "command": ".claude/hooks/auto-doc-sync.sh Edit"},
          {"type": "command", "command": ".claude/hooks/phase-progress.sh Edit"},
          {"type": "command", "command": ".claude/hooks/post-tool-use-tracker.sh Edit"},
          {"type": "command", "command": ".claude/hooks/state-transition.sh Edit"},
          {"type": "command", "command": ".claude/hooks/craft-progress.sh Edit"},
          {"type": "command", "command": ".claude/hooks/notion-sync.sh Edit"}
        ]
      }
    ],
    "Notification": [
      {
        "matcher": "*",
        "hooks": [{"type": "command", "command": ".claude/hooks/notification-handler.sh"}]
      }
    ]
  },
  "agile": {
    "auto_changelog": true,
    "auto_readme_sync": true,
    "sprint_tracking": true,
    "velocity_tracking": true,
    "sync_on_commit": true
  },
  "phase": {
    "enabled": true,
    "auto_progress_update": true,
    "auto_check_completion": true,
    "notify_on_completion": true,
    "document_structure": {
      "spec": "SPEC.md",
      "tasks": "TASKS.md",
      "checklist": "CHECKLIST.md"
    },
    "templates": {
      "location": ".claude/templates/phase",
      "spec_template": "SPEC.md",
      "tasks_template": "TASKS.md",
      "checklist_template": "CHECKLIST.md"
    }
  },
  "sprint": {
    "enabled": true,
    "default_duration": "2w",
    "point_scale": [1, 2, 3, 5, 8, 13],
    "auto_velocity_track": true,
    "auto_retro_generate": true,
    "burndown_chart": "ascii",
    "daily_reminder": false,
    "phase_integration": {
      "enabled": true,
      "link_to_phase": true,
      "auto_update_phase_tasks": true,
      "pull_tasks_from_phase": true
    }
  },
  "quality-gate": {
    "pre-commit": {
      "enabled": true,
      "checks": ["lint", "format", "types", "secrets"],
      "auto_fix": false
    },
    "pre-merge": {
      "enabled": true,
      "coverage_threshold": 80,
      "require_review": true,
      "require_changelog": true
    },
    "pre-build": {
      "enabled": true,
      "checks": ["content_json_schema", "tokens_css_completeness", "no_placeholders"],
      "trigger": "building_to_validating",
      "phase": "3_to_3.5"
    },
    "pre-deploy": {
      "enabled": true,
      "checks": ["all_validation_passed", "site_builds", "deploy_config_valid"],
      "trigger": "build_review_to_deploying",
      "phase": "3.5_to_4"
    },
    "pre-release": {
      "enabled": true,
      "coverage_threshold": 80,
      "security_scan": true,
      "require_all_docs": true
    },
    "post-release": {
      "auto_archive_sprint": true,
      "generate_release_notes": true,
      "prompt_retro": true
    }
  },
  "feedback": {
    "auto_prompt_on_fix": true,
    "auto_prompt_on_arch_change": true,
    "learning_categories": ["bugs", "performance", "security", "architecture", "tooling", "process"],
    "adr_auto_number": true,
    "retro_template": "full",
    "review_default_count": 10
  },
  "context-optimizer": {
    "enabled": true,
    "auto_load_phase_docs": true,
    "loading_strategy": "incremental",
    "initial_budget": 800,
    "claude_md_template": "lean",
    "agent_manifest": ".claude/agents/MANIFEST.md",
    "checkpoint": {
      "enabled": true,
      "threshold_percent": 80,
      "output_dir": "docs/sessions"
    },
    "token_budget": {
      "quick": 2000,
      "standard": 10000,
      "deep": 30000,
      "full": 50000
    },
    "expansion_triggers": {
      "phase_work": "+phase_docs",
      "architecture": "+tech_spec+adjacent_phases",
      "review": "+prd+checklist",
      "full_status": "+progress+all_phase_summaries"
    },
    "context_boundary": {
      "default": "task-active",
      "levels": {
        "task-active": "current_task+related_source",
        "phase-full": "task-active+spec+checklist",
        "cross-phase": "phase-full+adjacent_specs+tech_spec"
      }
    }
  },
  "documents": {
    "standard_locations": {
      "discovery": "docs/DISCOVERY.md",
      "progress": "docs/PROGRESS.md",
      "context": "docs/CONTEXT.md",
      "prd": "docs/PRD.md",
      "tech_spec": "docs/TECH-SPEC.md",
      "phases": "docs/phases/",
      "adr": "docs/adr/",
      "feedback": "docs/feedback/",
      "sprints": "docs/sprints/"
    }
  },
  "discovery": {
    "enabled": true,
    "require_before_docs": true,
    "conversation_style": "friendly",
    "auto_confirm": false,
    "complexity_thresholds": {
      "LOW": 3,
      "MEDIUM": 6,
      "HIGH": 10
    }
  },
  "sync": {
    "enabled": true,
    "framework_source": "open-claude-office",
    "merge_strategy": {
      "agents": "add_missing",
      "skills": "add_missing",
      "commands": "add_missing",
      "hooks": "add_missing",
      "settings": "deep_merge"
    },
    "preserve_project_customizations": true,
    "backup_before_sync": true,
    "core_components": {
      "agents": [
        "file-explorer", "tech-spec-writer", "progress-tracker", "phase-tracker",
        "doc-generator", "project-analyzer", "code-reviewer", "doc-splitter",
        "test-helper", "git-troubleshooter", "google-searcher", "prd-writer",
        "dev-docs-writer", "config-validator", "pr-creator", "commit-helper",
        "doc-validator", "work-unit-manager", "branch-manager", "refactor-assistant",
        "project-discovery", "analytics-reporter", "github-manager",
        "readme-helper", "agent-writer",
        "MANIFEST"
      ],
      "skills": [
        "init", "validate", "sprint", "agile-sync", "brainstorming",
        "context-optimizer", "feedback-loop", "hook-creator", "subagent-creator",
        "skill-creator", "prompt-enhancer", "dev-doc-system", "quality-gate",
        "sync-fix", "repair", "readme-sync", "analytics", "gh",
        "notion", "stitch-skills", "remotion", "claude-office"
      ],
      "commands": [
        "feature", "bugfix", "release", "phase", "git-workflow", "dev-doc-planner"
      ],
      "hooks": [
        "phase-progress.sh", "pre-tool-use-safety.sh", "post-tool-use-tracker.sh",
        "notification-handler.sh", "auto-doc-sync.sh",
        "state-transition.sh", "craft-progress.sh",
        "notion-sync.sh"
      ]
    },
    "auto_run_validation": true,
    "report_changes": true
  },
  "project": {
    "_comment": "User's project repo - auto-detected from git remote or manually set",
    "repo": "",
    "owner": "",
    "name": "",
    "default_branch": "main",
    "auto_detect": true
  },
  "update": {
    "_comment": "open-pantheon framework source - NOT your project repo",
    "enabled": true,
    "source_locations": [
      "~/dev/open-claude-office",
      "~/.open-claude-office"
    ],
    "env_var": "CC_INITIALIZER_PATH",
    "framework_repo": "https://github.com/tygwan/open-claude-office.git",
    "default_branch": "main",
    "auto_sync_after_update": true,
    "show_changelog": true,
    "require_confirmation": true
  },
  "safety": {
    "block_dangerous_commands": true,
    "warn_on_sensitive_files": true,
    "require_confirmation_for_destructive": true
  },
  "validation": {
    "auto_check_on_start": false,
    "strict_mode": false,
    "ignore_patterns": ["*.backup", "*.tmp"],
    "required_agents": ["project-discovery", "progress-tracker", "phase-tracker", "dev-docs-writer"],
    "required_hooks": ["phase-progress.sh", "pre-tool-use-safety.sh"],
    "required_skills": ["init", "validate", "sprint", "agile-sync"]
  },
  "recovery": {
    "enabled": true,
    "auto_recover_on_hook_failure": true,
    "max_retry_count": 3,
    "log_retention_days": 7,
    "graceful_degradation": true,
    "critical_hooks": ["pre-tool-use-safety.sh"],
    "non_critical_hooks": ["auto-doc-sync.sh", "phase-progress.sh", "post-tool-use-tracker.sh", "notification-handler.sh", "state-transition.sh", "craft-progress.sh", "notion-sync.sh"],
    "auto_fixable": {
      "hook_permissions": true,
      "missing_directories": true,
      "log_rotation": true
    },
    "manual_required": {
      "missing_docs": ["PROGRESS.md", "CONTEXT.md"],
      "invalid_json": true
    },
    "log_settings": {
      "log_dir": ".claude/logs",
      "error_log": "error.log",
      "recovery_log": "recovery.log",
      "max_log_size_mb": 1,
      "max_log_files": 5
    }
  },
  "analytics": {
    "enabled": true,
    "track_tool_usage": true,
    "track_agent_calls": true,
    "track_skill_invocations": true,
    "metrics_file": ".claude/analytics/metrics.jsonl",
    "retention_days": 30,
    "aggregation": {
      "hourly_rollup": true,
      "daily_summary": true
    }
  },
  "github": {
    "enabled": true,
    "cli_path": "gh",
    "default_base_branch": "main",
    "pr": {
      "auto_assign_reviewers": false,
      "draft_by_default": false,
      "template": ".github/PULL_REQUEST_TEMPLATE.md",
      "squash_merge": true
    },
    "issue": {
      "default_labels": [],
      "auto_assign": true,
      "link_to_branch": true
    },
    "ci": {
      "watch_timeout": 600,
      "auto_rerun_failed": false,
      "notify_on_failure": true
    },
    "release": {
      "generate_notes": true,
      "draft_by_default": false,
      "include_changelog": true
    }
  },
  "lifecycle": {
    "current_stage": "mvp",
    "stages": {
      "mvp": {
        "description": "Make it work — minimum viable, expect to change later",
        "quality_gates": {
          "coverage": 30,
          "tests": "unit_only",
          "security": "baseline",
          "docs": "README"
        }
      },
      "poc": {
        "description": "Make it verifiable — usable by real users",
        "quality_gates": {
          "coverage": 60,
          "tests": "unit_integration_e2e",
          "security": "sast_deps",
          "docs": "README_API-SPEC_ERD"
        }
      },
      "production": {
        "description": "Make it operable — resilient to failures",
        "quality_gates": {
          "coverage": 80,
          "tests": "full_suite",
          "security": "sast_dast_pen",
          "docs": "full_runbook_sla"
        }
      }
    }
  },
  "craft": {
    "state_schema": "workspace/.state-schema.yaml",
    "default_template": "auto",
    "css_prefix": "--pn-",
    "cli_distribution": {
      "codex": { "sandbox": "read-only", "default_model": "gpt-5-mini", "fallback_model": "gpt-5-codex" },
      "gemini": { "auto_accept": true, "default_model": "gemini-2.5-flash", "fallback_model": "gemini-2.5-pro" }
    },
    "fallback_strategy": "cli_fail_retry_once_then_claude",
    "portfolio_integration": {
      "portfolio_path": "/home/coffin/dev/portfolio",
      "auto_sync": false
    }
  },
  "notion": {
    "enabled": false,
    "sync": {
      "auto_push_on_task_change": true,
      "auto_push_on_commit": true,
      "auto_pull_on_session_start": true,
      "push_documents": false,
      "conflict_resolution": {
        "rules": {
          "tasks": { "status": "local_wins", "priority": "notion_wins", "assignee": "notion_wins", "due_date": "notion_wins", "default": "latest_wins" },
          "projects": { "stage": "local_wins", "progress": "local_wins", "health": "local_wins", "priority": "notion_wins", "description": "notion_wins", "default": "latest_wins" },
          "documents": { "default": "notion_wins" },
          "gates": { "default": "local_wins" },
          "sprints": { "velocity": "local_wins", "planned_pts": "notion_wins", "goal": "notion_wins", "status": "local_wins", "default": "latest_wins" },
          "tech_debt": { "severity": "notion_wins", "status": "local_wins", "default": "latest_wins" },
          "feedback": { "default": "notion_wins" },
          "activity_log": { "default": "local_wins" }
        },
        "fallback": "latest_wins"
      }
    },
    "databases": {
      "projects": "",
      "tasks": "",
      "gates": "",
      "documents": "",
      "sprints": "",
      "tech_debt": "",
      "feedback": "",
      "activity_log": ""
    },
    "cache": {
      "dir": ".claude/cache/notion",
      "ttl_minutes": 5,
      "auto_refresh_on_session_start": true
    }
  },
  "external_skills": {
    "stitch_skills": {
      "enabled": true,
      "repo": "google-labs-code/stitch-skills",
      "sub_skills": ["design-md", "react-components", "stitch-loop", "enhance-prompt", "remotion", "shadcn-ui"],
      "auto_install": false
    },
    "remotion": {
      "enabled": true,
      "repo": "remotion-dev/skills",
      "auto_install": false,
      "output_dir": "out/videos"
    },
    "claude_office": {
      "enabled": true,
      "repo": "tfriedel/claude-office-skills",
      "auto_install": false,
      "output_dir": "out/documents"
    }
  }
}